#!/bin/bash
branch=`git reflog show --pretty='%gs' | grep 'checkout:' | head -1 | sed -E 's/.*moving from ([^ ]+) to.*/\1/'`
git --no-pager diff $branch... $1